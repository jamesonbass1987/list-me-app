<h1>Listing Overview</h1>

<p><%= full_location_name(@listing.location) %></p>
<h3><%= @listing.title %></h3>

<% @listing.listing_images.each do |image| %>
  <%= image_tag(image.image_url, :class => 'listing-image') %>
<% end %>

<h3>Description:</h4>
<%= @listing.description %><br>
<strong>Price:</strong> <%= number_to_currency(@listing.price) %><br>
<strong>Posted By:</strong> <%= @listing.user.username %><br>
<strong>Category:</strong> <%= @listing.category.name %><br>
<strong>Tags:</strong> <%= @listing.tags.collect{|tag| tag.name}.join(", ") %><br>

<%= delete_edit_listing_links(@listing) %>

<h3>Comments:</h3>
<% if !@listing.comments.first.content.nil? %>
  <ul>
    <% @listing.comments.each do |comment| %>
      <% if !comment.content.nil? %>
        <li>

          <strong><%= comment.user.username %></strong>: <%= comment.content %><br>
          <% if comment.user != @listing.user %>
            <strong>Status:</strong> <%= comment.comment_status.name %><br>
          <% end %>
            <strong>Posted At:</strong> <%= comment.created_at %><br>

          <%= display_comment_controls(comment) %>
        </li>
      <% end %>
    <% end %>
  </ul>
<% end %>

<% if logged_in? %>
  <h5>Leave A Question About The Item:</h5>
  <%= render 'comment_form', locals: {comment: @comment, listing: @listing} %>
<% end %>
